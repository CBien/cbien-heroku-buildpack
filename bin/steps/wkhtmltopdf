#!/usr/bin/env bash

set -e

BIN_PATH="$1/bin/"
mkdir -p $BIN_PATH

WKHTMLTOPDF_FILENAME="wkhtmltopdf-0.11.0_rc1-static-amd64.tar.bz2"
WKHTMLTOPDF_BINARY="https://wkhtmltopdf.googlecode.com/files/$WKHTMLTOPDF_BINARY"
WKHTMLTOPDF_BINARY_NAME="wkhtmltopdf-amd64"
WKHTMLTOPDF_PATH="$1/bin/wkhtmltopdf"
WKHTMLTOX_PATH="$1/bin/wkhtmltox"

echo "-----> wkhtmltopdf: Curl wkhtmltopdf compressed binary"
curl -L $WKHTMLTOPDF_BINARY -o $WKHTMLTOPDF_FILENAME

echo "-----> wkhtmltopdf: Decompressing binary"
tar xjf $WKHTMLTOPDF_FILENAME

echo "-----> wkhtmltopdf : Removing compressed binary"
rm -f $WKHTMLTOPDF_FILENAME

echo "-----> wkhtmltopdf : Moving binary to the bin dir"
mv $WKHTMLTOPDF_BINARY_NAME $WKHTMLTOPDF_PATH

echo "-----> wkhtmltopdf : Setting permissions"
chmod +x $WKHTMLTOPDF_PATH